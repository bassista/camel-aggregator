<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- ~ Copyright (C) Red Hat, Inc. ~ http://www.redhat.com ~ ~ Licensed under 
	the Apache License, Version 2.0 (the "License"); ~ you may not use this file 
	except in compliance with the License. ~ You may obtain a copy of the License 
	at ~ ~ http://www.apache.org/licenses/LICENSE-2.0 ~ ~ Unless required by 
	applicable law or agreed to in writing, software ~ distributed under the 
	License is distributed on an "AS IS" BASIS, ~ WITHOUT WARRANTIES OR CONDITIONS 
	OF ANY KIND, either express or implied. ~ See the License for the specific 
	language governing permissions and ~ limitations under the License. -->

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:camel="http://camel.apache.org/schema/spring" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:osgix="http://www.springframework.org/schema/osgi-compendium"
	xmlns:ctx="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd 
	                    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                        http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd
                        http://www.springframework.org/schema/osgi-compendium http://www.springframework.org/schema/osgi-compendium/spring-osgi-compendium.xsd">

    <!-- Getting the properties file from OSGi -->
    <cm-properties xmlns="http://www.springframework.org/schema/osgi-compendium" id="preProps" persistent-id="aggregatorapp" />
    
    <!-- Injecting the properties file in Spring Container -->
    <property-placeholder xmlns="http://www.springframework.org/schema/context" properties-ref="preProps" /> 

	<bean id="activemq" class="org.apache.activemq.camel.component.ActiveMQComponent">
		<!--<property name="brokerURL" value="tcp://localhost:61616" />-->
		<property name="brokerURL" value="${brokerurl}"/>
		<property name="userName" value="admin"/>
		<property name="password" value="admin"/>
	</bean>

	<bean id="userRoutes" class="com.fusesource.byexample.hellocamel.route.AggregatorRouteBuilder" />

	<camelContext id="myCamel" xmlns="http://camel.apache.org/schema/spring">
       <propertyPlaceholder location="file:${karaf.home}/etc/aggregatorapp.cfg" id="properties"/>
       <routeBuilder ref="userRoutes"/>
    </camelContext>
</beans>